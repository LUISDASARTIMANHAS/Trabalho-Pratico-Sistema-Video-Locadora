import{a as k,j as a,L as b,r as c,P as q,u as B,R as H,b as W,c as N,B as J,d as G}from"./vendor-D4GMNni7.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const Z=""+new URL("video-locadora-retro-logo-M4WB8AE4.png",import.meta.url).href,Q={VITE_BACKEND_DOMAIN:"147.185.221.212",VITE_BACKEND_PORT:"48815",VITE_PRODUCTION_URL:"https://my-json-server.typicode.com/typicode/demo/"},{VITE_BACKEND_PORT:X,VITE_BACKEND_DOMAIN:Y,VITE_PRODUCTION_URL:ee}=Q;async function ae(e){try{await E.post("/telemetria",{mensagem:"Erro ao comunicar com API",erro:e,timestamp:new Date().toISOString()})}catch(t){console.error("Erro ao enviar telemetria:",t.message)}}async function A(e,...t){try{const s=await e(...t);if(!s)throw new Error(`Resposta inválida da API: ${s}`);if(s.status===204)return null;if(s.data===void 0||s.data===null||typeof s.data!="object")throw new Error(`Resposta inválida da API: ${JSON.stringify(s.data)}`);const o=s.data,r=o.content??o.data??o.result??o??null;if(r===null)throw new Error("Nenhum campo de conteúdo encontrado em response.data");return r}catch(s){throw await ae(s.message||s.toString()),s}}async function te(){return A(le.get,"posts",{headers:{Accept:"application/json"}})}async function se(e){return A(E.get,e,{headers:{Accept:"application/json"}})}async function V(e,t){return A(E.post,e,t)}async function oe(e,t,s){return A(E.put,`${e}/${t}`,s)}async function re(e,t){return A(E.delete,`${e}/${t}`)}function L(e,t="info"){typeof window.addAlert=="function"?window.addAlert(e,t):console.warn(`[ALERTA] ${t.toUpperCase()}: ${e}`)}function U(e){return e&&e=="local"?`http://${Y}:${X}/api`:ee}const ne=["atores","classes","diretores"],E=k.create({baseURL:U("local"),timeout:1e4,headers:{Authorization:`Bearer ${new Date}`,"Content-Type":"application/json"}}),le=k.create({baseURL:U("production"),timeout:1e4,headers:{Authorization:`Bearer ${new Date}`,"Content-Type":"application/json"}});let j={};async function y(e){const t=`${e}Array`;try{L(`🔄 Carregando ${e} da API...`,"info");const s=await se(e);return j[t]=s,L(`✅ ${e} carregado da API!`,"success"),console.log(`[API] Dados carregados de ${e}:`,s),s}catch{console.warn(`[LOCAL] Falha ao carregar ${e} da API, usando dados APIdemo.`);const o=await te();return j[t]=o,L(`⚠️ Usando dados APIdemo para ${e}`,"warning"),o}}async function ce(){for(const e of ne)await y(e)}const ie=()=>a.jsx("header",{className:"navbar navbar-dark bg-dark px-3 justify-content-between",children:a.jsxs(b,{to:"/",className:"navbar-brand d-flex align-items-center",children:[a.jsx("img",{src:Z,alt:"VideoLocadora",style:{height:"40px",marginRight:"10px"}}),a.jsx("span",{children:"VideoLocadora"})]})}),z=({message:e,type:t="success",duration:s=3e3})=>{const[o,r]=c.useState(!0);return c.useEffect(()=>{const n=setTimeout(()=>r(!1),s);return()=>clearTimeout(n)},[s]),o?a.jsx("div",{className:`auto-alert alert alert-${t} alert-dismissible fade show`,role:"alert",children:e}):null},F=({show:e,title:t,message:s,onConfirm:o,onCancel:r})=>{if(!e)return null;const n=()=>{o&&o()},i=()=>{r&&r()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"modal-backdrop-fade"}),a.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",role:"dialog",children:a.jsx("div",{className:"modal-dialog",children:a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{className:"modal-title",children:t}),a.jsx("button",{type:"button",className:"btn-close",onClick:i})]}),a.jsx("div",{className:"modal-body",children:a.jsx("p",{children:s})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:i,children:"Cancelar"}),a.jsx("button",{className:"btn btn-primary",onClick:n,children:"Ok"})]})]})})})]})},de=()=>a.jsx("main",{className:"container mt-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"mb-3",children:"🎬 Bem-vindo à Vídeo Locadora!"}),a.jsx(z,{message:"SISTEMA INICIALIZADO!",type:"success",duration:5e3}),a.jsx("img",{className:"img-fluid w-50",src:"./src/assets/logo/video-locadora-retro-logo.png",alt:"Bem-vindo à Vídeo Locadora!"}),a.jsx("p",{className:"lead",children:"Explore nossa coleção de filmes e séries."})]})}),me=()=>a.jsx(de,{}),ue=()=>a.jsxs("main",{className:"main not-found",children:[a.jsx("h1",{children:"404 - Página Não Encontrada"}),a.jsx("p",{children:"A página que você tentou acessar não existe ou foi removida."}),a.jsx(b,{to:"/",className:"back-home",children:"← Voltar para a página inicial"})]});await y("atores");console.log("[DB CONTROLLER ATORES]: ",j);let I=j.atoresArray;(!I||I.length===0)&&(console.log("Usando dados locais para atores.js"),I=[{_id:1,nome:"ator 1",nacionalidade:"brasileiro"},{_id:2,nome:"ator 2",nacionalidade:"americano"}]);await y("classes");console.log("[DB CONTROLLER CLASSES]: ",j);let S=j.classesArray;(!S||S.length===0)&&(console.log("Usando dados locais para classes.js"),S=[{_id:1,nome:"lancamento",valor:5,dataDevolucao:"01/10/2025"},{_id:2,nome:"comum",valor:3,dataDevolucao:"02/10/2025"}]);await y("diretores");console.log("[DB CONTROLLER DIRETOR]: ",j);let $=j.diretoresArray;(!$||$.length===0)&&(console.log("Usando dados locais para diretores.js"),$=[{_id:1,name:"administrador"},{_id:2,name:"teste"}]);const R=["ativo","data_nascimento","nacionalidade","Nacionalidade"],K=[{name:"atores",label:"Atores",data:P(R,I)},{name:"classes",label:"Classes",data:P(R,S)},{name:"diretores",label:"Diretores",data:P(R,$)}];function he(e,t){return t.find(o=>C(o)===Number(e))}function fe(e){return K.find(t=>t.name==e)}function xe(e){if(Array.isArray(e)){if(e.length>0&&typeof e[0]=="object"&&e[0]!==null)return console.log("[extractKeys] input[0]:",e[0]),Object.keys(e[0])}else if(typeof e=="object"&&e!==null)return Array.isArray(e.newPageFields)?(console.log("[extractKeys] input.newPageFields:",e.newPageFields),e.newPageFields):Array.isArray(e.data)&&e.data.length>0&&typeof e.data[0]=="object"?(console.log("[extractKeys] input.data[0]:",e.data[0]),Object.keys(e.data[0])):(console.log("[extractKeys] input:",e),Object.keys(e));return console.warn("[extractKeys] Formato de input inesperado:",e),[]}function p(e){return e?e.nome||e.name||e.titulo||e.title||e.id||e._id||"Item Selecionado":"[getTitleItem] NO ITEM PROVIDE"}function C(e){return e?e._id||e.id||null:"[getIDtem] NO ITEM PROVIDE"}function P(e,t){return Array.isArray(t)&&typeof t[0]=="string"?t.filter(s=>!e.includes(s)):Array.isArray(t)&&typeof t[0]=="object"?t.map(s=>Object.fromEntries(Object.entries(s).filter(([o])=>!e.includes(o)))):typeof t=="object"&&t!==null?Object.fromEntries(Object.entries(t).filter(([s])=>!e.includes(s))):(console.warn("[filtrarCampos] Tipo de dados inesperado:",t),t)}const D=({message:e="Carregando"})=>a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"spinner-border text-light",role:"status",style:{width:"4rem",height:"4rem"},children:a.jsx("span",{className:"visually-hidden",children:"Carregando..."})}),a.jsxs("p",{className:"mt-3 text-white",children:[e,"..."]})]});D.propTypes={message:q.string};const ge=({data:e,fields:t})=>{const[s,o]=c.useState(!1),r=["id","_id"];if(!e||e.length===0)return a.jsx("p",{className:"text-muted",children:"Nenhum dado disponível."});const n=t||xe(e),i=P(r,n),{moduleName:m}=B(),[u,h]=c.useState(!1),[x,l]=c.useState(null),d=f=>{console.log("[DynamicTable] Solicitando exclusão de:",f),l(f),h(!0)},g=()=>{x&&O(x),h(!1),l(null)},v=()=>{console.log("[DynamicTable] Exclusão cancelada"),h(!1),l(null)},O=async f=>{try{o(!0),window.addAlert(`🗑️ Excluindo ${m}...`,"warning"),window.addAlert("📤 Enviando requisição de exclusão...","info"),await re(m,C(f)),window.addAlert(`✅ ${p(f)} removido com sucesso!`,"success"),console.log("[DynamicTable] Item deletado com sucesso!")}catch(w){window.addAlert(`❌ Erro ao excluir! ${w}`,"danger"),console.error("[DynamicTable] Erro ao deletar item:",w)}finally{window.addAlert("🏁 Processo de exclusão concluído","success"),o(!1)}};return console.log("DynamicTable renderizou com:",e),a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"table table-striped table-bordered table-hover",children:[a.jsx("thead",{className:"table-dark",children:a.jsxs("tr",{children:[i.map(f=>a.jsx("th",{children:f.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())},f)),a.jsx("th",{children:"Ações"})]})}),a.jsx("tbody",{children:e.map((f,w)=>a.jsxs("tr",{children:[i.map(M=>a.jsx("td",{children:f[M]},M)),a.jsxs("td",{children:[a.jsx(b,{to:`/${m}/editar/${C(f)}`,className:"btn btn-sm btn-warning me-2",children:"Editar"}),a.jsx("button",{onClick:()=>d(f),className:"btn btn-sm btn-danger",children:"Excluir"})]})]},w))})]}),a.jsx(F,{show:u,title:"Confirmação de exclusão",message:`Deseja realmente excluir o item "${p(x)}"?`,onConfirm:g,onCancel:v}),s&&a.jsx(D,{message:`Deletando ${m}`})]})},pe=({moduleConfig:e})=>{const[t,s]=c.useState([]);return c.useEffect(()=>{Array.isArray(e.data)?s([...e.data]):s([])},[JSON.stringify(e.data)]),console.log("Rendering ListPage with data:",t),a.jsxs("div",{children:[a.jsxs("h1",{children:["Lista de ",e.label]}),a.jsxs(b,{to:`/${e.name}/novo`,style:{display:"inline-block",marginBottom:"20px"},children:["+ Inserir novos ",e.label]}),a.jsx(ge,{data:t},JSON.stringify(t))]})},_=({btnTextContent:e="Salvar",exampleObject:t={},onSubmit:s,initialValues:o={}})=>{const[r,n]=c.useState({}),[i,m]=c.useState(null);console.log("[FORM] Rendering Form with exampleObject (objeto de exemplo):",t),console.log("[FORM] Initial values:",o);const u=Object.entries(t).filter(([l])=>l!=="id"&&l!=="_id").map(([l,d])=>{let g="text";return typeof d=="number"?g="number":typeof d=="boolean"?g="checkbox":typeof d=="string"&&/^\d{2}\/\d{2}\/\d{4}$/.test(d)&&(g="date"),{name:l,label:l.replace(/_/g," ").replace(/\b\w/g,v=>v.toUpperCase()),type:g}});c.useEffect(()=>{!t||typeof t!="object"||Array.isArray(t)?(console.error("[FORM] Erro: 'exampleObject' deve ser um objeto exemplo, ex: { nome: 'abc', valor: 5 }"),m("Erro: formato inválido de campos. Esperado um objeto exemplo, como { nome: 'abc', valor: 5 }.")):m(null)},[t]),c.useEffect(()=>{n(o)},[o]);const h=l=>{const{name:d,type:g,value:v,checked:O}=l.target;n({...r,[d]:g==="checkbox"?O:v})},x=l=>{l.preventDefault(),s(r)};return i?a.jsx("div",{className:"alert alert-danger",role:"alert",children:i}):a.jsxs("form",{onSubmit:x,className:"p-3 border rounded bg-light",children:[u.map(l=>a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:l.name,className:"form-label",children:l.label}),a.jsx("input",{id:l.name,name:l.name,type:l.type,className:"form-control",value:l.type==="checkbox"?void 0:r[l.name]||t[l.name]||"",checked:l.type==="checkbox"?r[l.name]||!1:void 0,onChange:h,required:!0})]},l.name)),a.jsx("button",{type:"submit",className:"btn btn-primary",children:e})]})},je=({moduleConfig:e})=>{const t=e.data?.[0]||{},[s]=c.useState(t),[o,r]=c.useState(null),[n,i]=c.useState(!1),[m,u]=c.useState(!1),h=l=>{console.log("[NewPage] Dados do form:",l),r(l),i(!0)},x=async()=>{try{u(!0),i(!1),window.addAlert(`🔄 Criando ${p(o)}...`,"info"),console.log("[NewPage] Criando item:",o),window.addAlert("📤 Enviando dados ao servidor...","info"),await V(e.name,o),window.addAlert(`✅ ${p(o)} criado com sucesso!`,"success"),console.log("[NewPage] Item salvo com sucesso!")}catch(l){window.addAlert(`❌ Falha ao criar! ${l}`,"danger"),console.error("[NewPage] Erro ao salvar item:",l)}finally{y(e.name),window.addAlert("✅ Processo finalizado","success"),u(!1)}};return a.jsxs("div",{children:[a.jsxs("h2",{children:["Inserir novos ",e.label]}),a.jsxs(b,{to:`/${e.name}`,style:{display:"inline-block",marginBottom:"20px"},children:["+ Ver ",e.label]}),a.jsx(_,{btnTextContent:`Inserir ${e.label}`,exampleObject:t,onSubmit:h,initialValues:s}),a.jsx(F,{show:n,title:"Confirmação",message:`Deseja realmente inserir ${p(o)}?`,onConfirm:x,onCancel:()=>i(!1)}),m&&a.jsx(D,{message:`Criando ${e.name}`})]})},be=({moduleConfig:e,id:t})=>{const s=he(t,e.data),[o]=c.useState(s||{}),[r,n]=c.useState(!1),[i,m]=c.useState(null),[u,h]=c.useState(!1);if(!s)return a.jsxs("div",{children:["Item com ID ",t," não encontrado."]});const x=d=>{console.log("[EditPage] Dados do form:",d),m(d),h(!0)},l=async()=>{try{const d=p(i);n(!0),h(!1),window.addAlert(`✏️ Atualizando ${d}...`,"info"),window.addAlert("📡 Enviando dados ao servidor...","info"),await oe(e.name,t,i),window.addAlert(`✅ ${d} atualizado com sucesso!`,"success"),console.log("[EditPage] Item atualizado com sucesso!")}catch(d){window.addAlert(`❌ Falha ao atualizar! ${d}`,"danger"),console.error("[EditPage] Erro ao salvar item:",d)}finally{y(e.name),window.addAlert("🏁 Processo finalizado","success"),n(!1)}};return a.jsxs("div",{className:"container flex flex-column align-items-center",children:[a.jsxs("h2",{children:["Editar ",e.label]}),a.jsxs(b,{to:`/${e.name}/novo`,style:{display:"inline-block",marginBottom:"20px"},children:["+ Inserir novos ",e.label]}),a.jsx(_,{btnTextContent:"Editar",exampleObject:s,onSubmit:x,initialValues:o}),a.jsx(F,{show:u,title:"Confirmação",message:`Deseja realmente editar ${p(s)} para ${p(i)}?`,onConfirm:l,onCancel:()=>h(!1)}),r&&a.jsx(D,{message:`Editando ${e.name}`})]})},T=({children:e})=>{const{moduleName:t,id:s}=B(),o=fe(t),[r,n]=c.useState(o?.data||[]);return c.useEffect(()=>{const i=async()=>{const u=await y(t);n(u)};i();const m=setInterval(i,15e3);return()=>clearInterval(m)},[t]),o?(console.log("ModuleWrapper recebeu novos dados:",o.data),console.log("ModuleWrapper: Renderizando módulo",t,o),H.cloneElement(e,{moduleConfig:{...o,data:r},id:s})):a.jsxs("h2",{children:["Módulo não encontrado: ",t]})},ye=({moduleConfig:e})=>{const[t,s]=c.useState(null),o={usuario:"string",senha:"string"},r=async n=>{console.log("[NewPage] Dados do form:",n),s(n);try{console.log("[NewPage] Criando item:",t),await V(e.name,t),console.log("Login efetuado com sucesso!")}catch(i){console.error("Erro ao fazer Login:",i)}};return a.jsxs("div",{children:[a.jsx("h1",{children:"login"}),a.jsx(_,{btnTextContent:"Entrar",exampleObject:o,onSubmit:r,initialValues:{}}),a.jsx(b,{to:"/home",children:"Go to Home"})]})},we=()=>a.jsxs(W,{children:[a.jsx(N,{path:"/",element:a.jsx(ye,{})}),a.jsx(N,{path:"/home",element:a.jsx(me,{})}),a.jsx(N,{path:"/:moduleName",element:a.jsx(T,{children:a.jsx(pe,{})})}),a.jsx(N,{path:"/:moduleName/novo",element:a.jsx(T,{children:a.jsx(je,{})})}),a.jsx(N,{path:"/:moduleName/editar/:id",element:a.jsx(T,{children:a.jsx(be,{})})}),a.jsx(N,{path:"*",element:a.jsx(ue,{})})]}),Ne=({links:e=[]})=>a.jsxs("aside",{className:"bg-light border rounded p-3",children:[a.jsx("h4",{className:"mb-3",children:"Menu"}),a.jsx("nav",{children:a.jsx("ul",{className:"list-group",children:e.map((t,s)=>a.jsx("li",{className:"list-group-item",children:a.jsx(b,{to:t.path,className:"text-decoration-none",children:t.label})},s))})})]}),ve=()=>`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,Ae=()=>{const[e,t]=c.useState([]),s=c.useCallback((o,r="info")=>{const n=ve(),m={success:5e3,info:6e3,warning:7e3,danger:8e3}[r]||5e3;t(u=>[...u,{id:n,message:o,type:r,duration:m}]),setTimeout(()=>{t(u=>u.filter(h=>h.id!==n))},m)},[]);return window.addAlert=s,a.jsx("div",{className:"alert-container",children:e.map(o=>a.jsx(z,{message:o.message,type:o.type,duration:o.duration},o.id))})},Ee=()=>{const[e,t]=c.useState(!1);c.useEffect(()=>{(async()=>{try{await ce()}catch(o){window.addAlert(`❌ Falha ao sincronizar dados! ${o}`,"danger")}finally{t(!0)}})()},[]);const s=[{path:"/home",label:"Início"},...K.flatMap(({name:o,label:r})=>[{path:`/${o}`,label:r},{path:`/${o}/novo`,label:`Novo ${r}`}])];return a.jsxs(J,{children:[a.jsx(ie,{}),a.jsx("div",{className:"container-fluid",children:a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-12 col-md-3 col-lg-2",children:a.jsx(Ne,{links:s})}),a.jsx("div",{className:"col-12 col-md-9 col-lg-10",children:a.jsx(we,{})})]})}),!e&&a.jsx(D,{}),a.jsx(Ae,{})]})};G.createRoot(document.getElementById("root")).render(a.jsx(c.StrictMode,{children:a.jsx(Ee,{})}));
